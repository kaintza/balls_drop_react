<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ball Drop React</title>
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.26.0/babel.js"></script>
    <style>
        .main {
            background-color: lightgray;
            position: absolute;
            width: 300px;
            height: 500px;
            z-index: 15;
            top: 50%;
            left: 50%;
            margin: -250px 0 0 -150px;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        }

        .ball_list_container {
            margin: 0;
            padding: 0;
            position: relative;
            width: 300px;
            height: 400px;
            background-color: white;
            overflow-y:auto;
        }

        .ball_list {
            list-style-type:none;
            width: auto;
            height: auto;
            background-color: white;
            margin: 0;
        }

        .button {
            margin: 10px auto;
        }

        .item1 {
            grid-column: 1 / 3;
        }

        .grid-container {
            z-index: 20;
            background-color: lightgray;
            position: relative;
            width: 300px;
            height: 100px;
            margin: 0;
            box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.2), 0 2px 4px 0 rgba(0, 0, 0, 0.19);
            text-align: center;
            display: grid;
            grid-template-columns: auto auto;
            grid-gap: 2px;
        }
    </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">

   class App extends React.Component {
       constructor(props) {
           super(props);
           this.state = {
               count:0,
           score: 0,
           color: ""}
       }

       handleClick() {
           const score = this.state.score;
           const count = this.state.count;
           this.setState({
               count: count + 1});
           let color = "undefined";
           let obj = new Object();
           obj.count = count + 1;
           let jsonString= JSON.stringify(obj);
           fetch('/ball', {
               method: 'POST',
               body: jsonString,
               headers:{
                   'Content-Type': 'application/json'
               }})
               .then((response) => {
                   return response.json();
               })
               .then((myJson) => {
                   color = myJson.color;
                   console.log(color);
                   this.setState({
                       color: color,
                       score: score + this.calculateScore(color)});
               });
       }

       calculateScore(color)
       {
           let scoreValues = {
               pink: 1,
               green: 3,
               blue: 5,
               purple: 15,
           };
           return scoreValues[color];
       }

       render() {
           const count = this.state.count;
           const score = this.state.score;
           const color = this.state.color;

           return (
               <div className="main">
                   <Header onClick={() => this.handleClick()} count={count} score={score}/>
                   <BallList color={color}/>
               </div>
           );
       }
   }

    class Header extends React.Component {
        render(props) {
          return (
          <div className="grid-container">
            <Drop onClick={this.props.onClick}/>
            <Counter count={this.props.count}/>
            <Score score={this.props.score}/>
          </div>
           );
        }
    }

    function BallList (props) {
        return <div className="ball_list_container">
            <ul className="ball_list"> </ul>
        </div>
    }

    function Counter (props) {
        return <p> Count:  {props.count} </p>;
    }

    function Score (props) {
        return <p> Score: {props.score}</p>;
    }

    function Drop (props) {
        return <button className="item1 button" onClick={props.onClick}>
            Drop
        </button>;
    }

    ReactDOM.render(<App/>, document.getElementById('root'));


</script>

</body>
</html>